---
title: DES
date: 2025-03-07 11:27:43
tags:
---

## **主要参数**
- **输入明文块：** 64 位
- **输出密文块：** 64 位
- **密钥长度：** 64 位（其中 8 位用于奇偶校验，实际有效密钥长度为 56 位）
- **加密轮数：** 16 轮
- **加密模式：** 基于 Feistel 结构
- **安全性：** 由于密钥较短（56 位），已被暴力破解（如 EFF 在 1999 年使用专用硬件破解 DES 仅需 22 小时）。

---

## **加密过程**
DES 采用 **Feistel 结构**，核心是**轮函数（F 函数）**，加密过程如下：
![main](/source/images/DES-main-network.png)

### **（1）初始置换（IP，Initial Permutation）**
- 对输入的 64 位明文进行固定的置换。
- 置换表如下（对 64 位明文重新排列）：
  
  | 58 | 50 | 42 | 34 | 26 | 18 | 10 |  2 |
  |----|----|----|----|----|----|----|----|
  | 60 | 52 | 44 | 36 | 28 | 20 | 12 |  4 |
  | 62 | 54 | 46 | 38 | 30 | 22 | 14 |  6 |
  | 64 | 56 | 48 | 40 | 32 | 24 | 16 |  8 |
  | 57 | 49 | 41 | 33 | 25 | 17 |  9 |  1 |
  | 59 | 51 | 43 | 35 | 27 | 19 | 11 |  3 |
  | 61 | 53 | 45 | 37 | 29 | 21 | 13 |  5 |
  | 63 | 55 | 47 | 39 | 31 | 23 | 15 |  7 |

- **作用**：增加混淆性，但可以直接逆向操作。

### **（2）分组（L0, R0）**
- **IP 置换后**，数据被拆分成左右两个 32 位部分：
  $$
  L_0, R_0
  $$

### **（3）16 轮 Feistel 结构**

**每一轮** $ i $ 进行如下操作：
$$
L_{i+1} = R_i
$$
$$
R_{i+1} = L_i \oplus F(R_i, K_i)
$$
其中：
- $ F(R_i, K_i) $ 是核心轮函数（包含 S-盒）。
- $ K_i $ 是该轮的 48 位子密钥。

**F 函数内部结构**
![feistel](/source/images/feistel-DES-f-function.png)
1. **扩展置换（E 扩展）**
   - 把 32 位 $ R_i $ 扩展成 48 位，以便与子密钥 $ K_i $ 进行 XOR。
   - 通过 E 扩展表复制部分位（位数增加）：
     $$
     E: \{32\} \to \{48\}
     $$

2. **子密钥 XOR**
   - 48 位扩展数据与 48 位子密钥 $ K_i $ 进行 XOR 操作。

3. **S-盒（Substitution Box）非线性变换**
   - DES 共有 **8 个 S-盒**，每个 S-盒接受 6 位输入(1,6位为行,中间4位为列号)，输出 4 位数据。
   - S-盒提供非线性映射，增强加密强度。
   - 与AES的s盒不同,这里不是一一对应的.

4. **P 置换（Permutation）**
   - S-盒输出的 32 位数据经过 **P 置换** 重新排列，以增加扩散性。

5. **最终输出 F(R, K)**
   - F 函数的输出 32 位，将用于下一轮的异或计算。

### **（4）16 轮后交换（Swap）**
- 经过 16 轮变换后，$ L_{16}, R_{16} $ 交换：
  $$
  \text{Swap}(L_{16}, R_{16})
  $$

### **（5）逆初始置换（IP⁻¹）**
- 最后进行 **IP⁻¹ 逆置换**，还原数据顺序，得到 64 位密文。

---

## **3. DES 密钥生成**
![key-gen](/source/images/DES-key-schedule.png)
### **（1）密钥置换 PC-1**
- 64 位密钥去掉 8 位奇偶校验位，得到 **56 位密钥**。

### **（2）密钥分割**
- 分割成两个 28 位的部分 $ C_0, D_0 $。

### **（3）16 轮密钥移位**
- 每轮将 $ C_i, D_i $ 左移 1 或 2 位。

### **（4）压缩置换 PC-2**
- 56 位密钥压缩为 **48 位子密钥**，用于 F 函数。

---

## **4. DES 解密过程**
- **解密与加密过程相同**，唯一不同的是**子密钥 $ K_i $ 的顺序反转**。
- 由于 XOR 变换和 Feistel 结构的可逆性，解密可以逐步还原原始明文。

---

## **5. DES 安全性分析**
### **（1）暴力破解**
- DES 仅使用 **56 位密钥**，即 $ 2^{56} $ 种可能性。
- **现代计算机可以在数小时内暴力破解**（1999 年 EFF 组织仅用 22 小时破解 DES）。
- **对策：使用 3DES（Triple DES）** 提高安全性。

### **（2）差分分析（Differential Cryptanalysis）**
- 1990 年被发现，针对 S-盒的设计进行分析，但 **DES S-盒已经优化**，使这种攻击成本较高。

### **（3）线性分析（Linear Cryptanalysis）**
- 1993 年被发现，使用线性逼近方法破解，但 **需要 $ 2^{43} $ 组明密文对**，对实际攻击影响不大。

---
