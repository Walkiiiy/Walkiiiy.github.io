---
title: DH密钥交换
date: 2025-02-20 08:44:24
tags:
---
## 数论基础：
* 离散对数问题难解性
* 循环群
* 模运算的幂运算性质
## 步骤:
* 双方交换a,P;Alice生成X1 < p,Bob生成X2 < p.
* Y1=a的X1次幂mod p
* Alice向Bob发送Y1
* Bob将Y1的X2次幂mod p后得到key2
* (**同时**)Y2=a的X2次幂mod p
* Bob想Alice发送Y2
* Alice将Y2的X1次幂modp后得到key1

由模幂运算性质:**结果都等于a的X1*X2次幂,即Key1=key2.**

## 小子群攻击
根据**循环群子群定理**,我们可以得到素数p的p-1阶模乘群的子群G及其生成元g,如果G的阶数很小且像这样的小子群足够多,就能进行小子群攻击.
该小子群不满足单射,但仍为循环群.
#### 步骤:
* Alice正常向Bob发送了自己计算得到的公钥$Y_1$
* Bob向Alice发送的公钥是小子群中的元素$Y_2$,由$a^{x_2}mod p$得到.
* Alice正常计算$Y_2^{x_1}mod p=k$作为共享密钥
* 该共享密钥Bob也计算得到$Y_1^{x_2}mod p=k$
* Bob知道k一定是$Y_2^{x_1}modp$得到的,而$Y_2$是在p的小子群中的,即已知$Y_2^{x_1}modp=k$,求$X_1$.
* 由于此时的$Y_2$不是本原根,无法形成双射,所以并不是一一对应.需要多次重复上述步骤后形成同余方程组,使用中国剩余定理CRT求解.
#### 防御:
**使用安全素数,规定素数p必须为2*q+1,其中q也为素数**
此时的阶数为2*q,只能分解为2和q这两个子群.